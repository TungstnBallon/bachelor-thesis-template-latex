\chapter{Evaluation}
\label{chapter:Evaluation}

The focus of the evaluation will be on the different runtimes of the various possible backends. These will be evaluated by running varouis prepared Jayvee models on one underlying dataset.

\section{Data source}
\label{section:data_source}

\subsection{Requirements}
%TODO: why not functional vs non-functional
\label{subsection:data_source_requirements}
\begin{enumerate}
	\item The dataset has to be available in a csv format, because the interpreter can only create tables from csv data.
	\item Jayvee tables can only contain boolean, text, integer and decimal values, so data other than that (e.g. dates) will not be parsed and represented as text.
	\item The dataset should be a minimum of $800\text{MB}$, to make the backend's differences in speed visible.
	\item The dataset should not be larger than $3\text{GB}$, because open-datasets are usually not that big. %FIXME: citation needed +  everything.
	\item The dataset must have an open license.% TODO: explanation. %TODO: list open licences
\end{enumerate}

The polars backend cannot transform dates, so the dataset must contain numbers or booleans.

\subsection{Chosen Dataset}
The chosen dataset is called "Brewery Operations and Market Analysis" and not based on any real wold data, but rather generated by a python script \autocite{dataset}.

\subsubsection{Biases}

\section{Parameters}
\label{section:parameters}
- what optimizations to use: typescript(none), pl(polars tables, columns and blocks), plob(pl + unified block to parse csv file into table), plrs(pl + sqlite loader with rust library extension), plobrs(plob + plrs)
- how many transformations: none, some, many
- how many lines of data should be processed: $6$ steps $100$, $1_000$, $10_000$, $100_000$, $1_000_000$, $10_000_000$

\section{Extended Capabilities}
- only plobrs can process the $10_000_000$ lines. others fail because
- plob: out of heap memory
- plrs, pl, ts: node cannot files larger than 2gb

\section{evaluation tool}
- cli allows to specify one or multiple values for the parameters.
- no value for a parameter means all possible values are used
- create configuration for every possible combination of the paramenters
- for each configuration  the jayvee interpreter is run with a set of prepared models fitting the parameters:
- the models get the path of the source file and the path of the destination from a command line parameter
- the source data files are created dynamically from a file with $10_000_000$ lines using the `head` cli tool: the avaluation tool can pass any lincount between 0 and $10_000_000$
- six models exist:
- 1-3: csv to table is done the usual way, then  *3 for no transforms, some transforms, and many transforms.
- 4-5: use the new block, then  *3 for no transforms, some transforms, and many transforms.
- no transforms: self explanatory
- some transforms:
- add column with ones
- sum "bitterness + volumes produced" into new col
-  "pH\_level" times 10 000, replace
- square root of total sales, new column

- the output databases are checked for equality using sqldiff



\section{the numbers}
%TODO: pie chart of supported transfrorms
%TODO: stuff that is not supported by jayvee
